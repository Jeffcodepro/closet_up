<nav class="navbar navbar-dark bg-dark">
  <div class="container-fluid d-flex justify-content-between align-items-center w-100 m-3">

    <a class="navbar-brand" href="/">Meu Marketplace</a>

    <div class="mx-auto" style="max-width: 500px; width: 100%;">
      <form class="d-flex" role="search">
        <input class="form-control me-2" type="search" placeholder="Buscar produtos" aria-label="Search">
        <button class="btn btn-outline-success" type="submit">
          <i class="bi bi-search"></i>
        </button>
      </form>
    </div>

    <ul class="navbar-nav d-flex flex-row gap-3 ms-auto">
      <% if user_signed_in? %>
        <li class="nav-item">
          <span class="nav-link text-white">Ol√°, <%= current_user.email %></span>
        </li>
        <li class="nav-item">
          <%= link_to "Adicionar Produto", new_product_path, class: "nav-link btn-add-product" %>
        </li>
        <li class="nav-item">
          <%= link_to edit_user_registration_path, class: "nav-link text-white" do %>
          <i class="bi bi-person fs-4"></i>
          <% end %>
        </li>
        <li class="nav-item">
          <%= link_to "Log out", destroy_user_session_path, data: {turbo_method: :delete}, class: "nav-link text-white" %>
        </li>
      <% else %>
        <li class="nav-item">
          <%= link_to "Entrar", new_user_session_path, class: "nav-link text-white" %>
        </li>
        <li class="nav-item">
          <%= link_to "Criar Conta", new_user_registration_path, class: "nav-link text-white" %>
        </li>
      <% end %>
    </ul>
  </div>
</nav>
<nav class="navbar navbar-dark bg-secondary">
  <div class="container-fluid">
    <ul class="navbar-nav d-flex flex-row w-100 justify-content-between overflow-auto">
      <% Category.all.each do |category| %>
        <li class="container nav-item text-center">
          <%= link_to products_by_category_path(category), class: "nav-link text-white px-2" do %>
            <%= category.title %>
          <% end %>
        </li>
      <% end %>
    </ul>
  </div>
</nav>


<div class="container">
  <div class="row py-4 g-4">
    <div class="col-md-4 d-flex justify-content-center align-items-center">
      <% if @order.product.images.attached? %>
        <%= cl_image_tag @order.product.images.first.key, class: "img-fluid rounded shadow-sm" %>
      <% end %>
    </div>

    <div class="col-md-8">
      <h1>Resumo do Pedido</h1>
      <p>Compra de produto <strong><%= @order.product.title %></strong> por <strong><%= humanized_money_with_symbol @order.amount %></strong> no tamanho de <strong><%= @order.size %></strong></p>

      <button id="pay" class="btn-go-to-checkout">Finalizar a compra</button>

      <script src="https://js.stripe.com/v3/"></script>
      <script>
        const paymentButton = document.getElementById('pay');
        paymentButton.addEventListener('click', () => {
          const stripe = Stripe('<%= ENV['STRIPE_PUBLISHABLE_KEY'] %>');
          stripe.redirectToCheckout({
            sessionId: '<%= @order.checkout_session_id %>'
          });
        });
      </script>
    </div>
  </div>
</div>
